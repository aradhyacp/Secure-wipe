create table users (
    id uuid primary key default gen_random_uuid() unique,
    name text not null,
    email text unique not null,
    password_hash text not null,
    product_key text not null unique,
    created_at timestamp default now()
);


create table certificates (
    id text primary key,
    product_key text NOT NULL REFERENCES users(product_key) ON DELETE CASCADE,
    device_name text not null,
    capacity text not null,
    passes text,
    wipe_date timestamp not null,
    method text not null,
    created_at timestamp default now(),
    hash text not null
);

create table user_stats (
    id uuid not null references users(id) on delete cascade primary key,
    product_key text not null references users(product_key) unique,
    total_wipes integer,
    certificates_issued integer
)